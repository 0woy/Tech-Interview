# 운영체제 개요 + 프로세스 & 스레드

## 운영체제의 역할

### 1. 프로세스 관리

CPU가 어떤 프로세스를 먼저 실행시킬지 프로세스 우선순위를 관리한다.

### 2. 메모리 관리

한정된 메모리를 어떤 프로세스에 얼마큼 할당해야 하는지 관리한다.

### 3. 디스크 파일 관리

프로그램을 하드디스크에 저장할 때 어떻게 저장할지 관리한다.

### 4. I/O 디바이스 관리

I/O 디바이스인 키보드, 마우스와 컴퓨터 간에 데이터를 주고받는 것을 관리한다.

---

## 커널

운영체제의 핵심적인 부분이자 시스템콜을 제공하며 
보안, 메모리, 프로세스, 파일 시스템, I/O 디바이스, I/O 요청 관리 등 운영체제의 중추적인 역할을 담당한다.

- 시스템콜 : 운영체제가 **커널에 접근하기 위한 인터페이스**
- I/O 요청 : 입출력 함수, 데이터베이스, 네트워크, 파일 접근 등에 관한 일

### 유저 모드 vs 커널 모드

- 유저 모드 : 유저가 접근할 수 있는 권한을 제한적으로 두며 컴퓨터 자원에 함부로 침범하지 못하는 모드
- 커널 모드 : 모든 컴퓨터 자원에 접근할 수 있는 모드

유저 프로그램이 I/O 요청을 하면 유저 모드가 시스템콜을 통해 커널 모드로 변환되어 실행되며, 
다시 시스템콜을 거쳐서 유저 모드로 변환된다. 
이 과정을 통해 컴퓨터 자원에 대한 직접 접근을 차단할 수 있고 프로그램을 다른 프로그램으로부터 보호할 수 있다.

---

## 프로세스 vs 스레드

- 프로세스 : 컴퓨터의 메모리에 올라와 실행되고 있는 프로그램을 말하며, task(CPU 스케줄링의 대상이 되는 작업)와 같은 의미로 쓰인다. 프로세스는 하나의 스레드만 있는 싱글 스레드 프로세스와 여러개의 스레드를 가진 멀티 스레드 프로세스로 나눠진다.
- 스레드 : 프로세스 내 작업의 흐름을 지칭한다.

### 프로세스와 스레드의 차이

1. 프로세스는 **코드, 데이터, 스택, 힙** 메모리 영역을 기반으로 작업하는 반면 스레드는 프로세스 내의 **스택** 메모리를 제외한 다른 메모리 영역을 프로세스 내의 다른 스레드들과 공유하기 때문에 메모리적 이점이 있다.
2. 프로세스는 다른 프로세스와 격리되어있기 때문에 서로 통신을 하기 위해서는 IPC를 사용해야 하지만 스레드는 다른 스레드와 서로 격리되어있지 않으므로 그냥 통신할 수 있으므로 프로세스보다 더 빠르다.
3. 프로세스는 한 프로세스에 문제가 생겨도 다른 프로세스에 영향을 끼치지 않지만 스레드는 격리가 되어있지 않아 한 스레드에 문제가 생기면 다른 스레드에도 영향을 끼쳐 스레드로 이루어져 있는 프로세스에 영향을 줄 수 있다.
4. 프로세스는 생성과 종료에 더 많은 시간이 들며 스레드는 더 적은 시간이 든다.

### 멀티프로세싱과 멀티스레딩

- 멀티프로세싱 : 여러 개의 '프로세스', 즉 멀티프로세스를 통해 동시에 두 가지 이상의 일을 수행할 수 있는 것을 말한다. 이를 통해 하나 이상의 일을 병렬로 처리할 수 있으며 특정 프로세스 중 일부에 문제가 발생하더라도 다른 프로세스에 영향을 미치지 않으므로 격리성과 신뢰성이 높은 강점이 있다.
- 멀티스레딩: 프로세스 내 작업을 여러 개의 '스레드', 즉 멀티스레드로 처리하는 기법이며 스레드끼리 서로 자원을 공유하고 프로세스보다는 가볍기 때문에 효율성이 높은 장점이 있다. 하지만 한 스레드에 문제가 생기면 다른 스레드에도 영향을 끼쳐 스레드로 이루어져 있는 프로세스에 영향을 줄 수 있는 단점이 있다.

[참고] 여러 개의 스레드 또는 프로세스를 만든 상태를 멀티스레드, 멀티프로세스라고 하며 
이를 기반으로 작업을 하는 것을 멀티스레딩, 멀티프로세싱이라고 한다.

### IPC (Inter-Process Communication)

프로세스끼리 데이터를 주고받고 공유 데이터를 관리하는 메커니즘을 뜻한다. 
클라이언트와 서버를 예로 들 수 있는데, 
클라이언트는 데이터를 요청하고 서버는 클라이언트 요청에 응답하는 것도 IPC의 예이다.

---

## 컨텍스트 스위칭

PCB를 기반으로 프로세스의 상태를 저장하고 다시 복원시키는 과정이다. 
이는 프로세스가 종료되거나 인터럽트에 의해 발생이 된다. 
컴퓨터는 많은 프로그램을 동시에 실행하는 것처럼 보이지만 
어떠한 시점에서 실행되고 있는 프로세스는 단 한 개이며, 
많은 프로세스가 동시에 구동되는 것처럼 보이는 것은 
다른 프로세스와의 컨텍스트 스위칭이 아주 빠른 속도로 실행되기 때문이다.

예를 들어, 한 개의 프로세스 A가 실행하다 멈추고, 
프로세스 A의 PCB를 저장하고 다시 프로세스 B를 복원하여 실행한다. 
그리고 다시 프로세스 B의 PCB를 저장하고 프로세스 A의 PCB를 복원한다.

컨텍스트 스위칭을 할 때마다 프로세스 당 유휴시간(사용하지 않는 시간)이 발생한다.

### 스레드에서의 컨텍스트 스위칭

컨텍스트 스위칭은 스레드에서도 일어난다. 
스레드는 스택 영역을 제외한 모든 메모리를 공유하기 때문에 
스레드 컨텍스트 스위칭의 경우 비용이 더 적고 시간도 더 적게 걸린다는 장점이 있다.

### PCB (Process Control Block)

운영체제에서 관리하는 프로세스에 대한 메타데이터를 저장한 데이터 블록이며 
각 프로세스가 생성될 때마다 고유의 PCB가 생성이 되고 프로세스가 종료되면 PCB는 제거된다.

[참고] 메타데이터 : 데이터에 관한 구조화된 데이터이자 데이터를 설명하는 작은 데이터, 
대량의 정보 가운데에서 찾고 있는 정보를 효율적으로 찾아내서 이용하기 위해 
일정한 규칙에 따라 콘텐츠에 대해 부여되는 데이터이다.

### 인터럽트

어떤 신호가 들어왔을 때 CPU를 잠깐 정지시키는 것을 말하며, 
0으로 숫자를 나누는 산술 연산오류, 프로세스 오류 등으로 발생한다. 
또한 오류뿐만 아니라 키보드, 마우스 등 IO 디바이스를 사용할 때의 인터럽트, 
우선순위가 높은 프로세스의 발생 등으로 발생한다.